(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DiscuzThreadView"],{2532:function(t,e,r){"use strict";var n=r("23e7"),a=r("5a34"),o=r("1d80"),s=r("ab13");n({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~String(o(this)).indexOf(a(t),arguments.length>1?arguments[1]:void 0)}})},"333d":function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"pagination"},[t.prevUrl?r("a",{staticClass:"btn prev-btn",on:{click:function(e){return t.gotoPage(t.prevUrl)}}},[t._v("上一页")]):t._e(),r("a",{staticClass:"btn currPageInfo"},[t._v(t._s(t.pageNum+"/"+t.pageCount))]),t.nextUrl?r("a",{staticClass:"btn next-btn",on:{click:function(e){return t.gotoPage(t.nextUrl)}}},[t._v("下一页")]):t._e()])},a=[],o=r("5530"),s=r("2f62"),i={props:["prevUrl","nextUrl","pageNum","pageCount"],computed:Object(o["a"])({},Object(s["c"])(["targetHost"])),methods:{gotoPage:function(t){this.$router.push(encodeURIComponent(t))}}},c=i,u=(r("a777"),r("2877")),l=Object(u["a"])(c,n,a,!1,null,"41e63b94",null);e["a"]=l.exports},"4cc1":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"discuzThread-page"},[r("Menus",{attrs:{url:t.url,tid:t.tid,fid:t.fid}}),r("div",{staticClass:"overflow-container"},[r("ul",{staticClass:"thread"},t._l(t.postList,(function(e,n){return r("li",{key:n,staticClass:"post"},[r("div",{staticClass:"post-info"},[r("span",[t._v(t._s(e.postFloor))]),r("span",[t._v(t._s(e.authorName))]),r("span",[t._v(t._s(e.authorLevel))]),r("div",{staticClass:"post-time"},[t._v(t._s(e.postTime))])]),r("h2",[t._v(t._s(e.postTitle))]),r("div",{staticClass:"post-content",domProps:{innerHTML:t._s(e.content)},on:{"!click":function(e){return t.routerTo(e)}}})])})),0),t.isLoading?t._e():r("Pagination",{attrs:{pageNum:t.pageInfo.pageNum,pageCount:t.pageInfo.pageCount,prevUrl:t.prevUrl,nextUrl:t.nextUrl}})],1)],1)},a=[],o=r("1da1"),s=r("5530"),i=(r("96cf"),r("99af"),r("5319"),r("ac1f"),r("159b"),r("caad"),r("2532"),r("2f62")),c=r("333d"),u=r("aa9a"),l=r("4260"),d={props:["url"],components:{Pagination:c["a"],Menus:u["a"]},data:function(){return{postList:[],tid:"",fid:"",pageInfo:{pageNum:1,pageCount:1}}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(i["d"])(["isLoading","discuz"])),Object(i["c"])(["targetHost"])),{},{prevUrl:function(){var t="",e=this.pageInfo.pageNum;return this.pageInfo&&1!=e&&(t="thread-".concat(this.tid,"-").concat(e-1,"-1.html")),t},nextUrl:function(){var t="",e=this.pageInfo,r=e.pageNum,n=e.pageCount;return this.pageInfo&&r<n&&this.url&&(t="thread-".concat(this.tid,"-").concat(r+1,"-1.html")),t}}),mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$route.query.tid&&(t.tid=t.$route.query.tid),e.prev=1,e.next=4,t.getThreadPageJson(t.url);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),console.log(e.t0);case 9:r=document.querySelector(".overflow-container"),t.$route.query.scrollTop?t.$nextTick((function(){r.scrollTop=t.$route.query.scrollTop})):t.$route.hash&&(r=document.querySelector(t.$route.hash),r&&r.scrollIntoView());case 11:case"end":return e.stop()}}),e,null,[[1,6]])})))()},beforeMount:function(){},destroyed:function(){},beforeRouteUpdate:function(t,e,r){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r(),e.next=3,n.getThreadPageJson(t.params.url);case 3:a=document.querySelector(".overflow-container"),t.hash?(a=document.querySelector(n.$route.hash),a&&a.scrollIntoView()):a.scrollTop=0;case 5:case"end":return e.stop()}}),e)})))()},methods:Object(s["a"])(Object(s["a"])({},Object(i["b"])(["getPageData"])),{},{getThreadPageJson:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,i,c,u,d,p,f,g,h,m;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n={},!sessionStorage.getItem(t)){r.next=5;break}n=JSON.parse(sessionStorage.getItem(t)),r.next=10;break;case 5:return a=l["l"].thread,r.next=8,e.getPageData({url:e.targetHost+t,selector:a});case 8:n=r.sent,sessionStorage.setItem(t,JSON.stringify(n));case 10:o=n,s=o.documentTitle,i=o.pageInfo,c=o.formhash,u=o.replyUrl,d=o.prevTopicUrl,p=o.nextTopicUrl,f=o.favoriteUrl,g=o.newThreadUrl,h=o.postList,m=void 0===h?[]:h,document.title=s,e.discuz.formhash=c,i&&(e.pageInfo=i),u?(e.tid=u.replace(/(^post.*tid=)(\d.*)(&extra=.*$)/g,"$2"),e.fid=u.replace(/(^post.*fid=)(\d.*)(&tid=.*$)/g,"$2")):d||p?(e.tid=(d||p).replace(/(^redirect.*tid=)(\d.*)(&goto=.*$)/g,"$2"),e.fid=(d||p).replace(/(^redirect.*fid=)(\d.*)(&tid=.*$)/g,"$2")):f&&g&&(e.tid=f.replace(/(^my.*tid=)(\d.*)(.*$)/g,"$2"),e.fid=g.replace(/(^post.*fid=)(\d.*)(&extra=.*$)/g,"$2")),e.postList=m,e.postList.forEach((function(t){t.content=t.content.replace(/[\t]/g,"").replace(/(\S)(<br>)(\S)/g,"$1$3").replace(/="attachment/g,'="'.concat(e.targetHost,"attachment")).replace(/="images/g,'="'.concat(e.targetHost,"images")).replace(/="http:\/\/(.*)\/bbs\//g,'="'.concat(e.targetHost)).replace(/:14pt/g,":5vw")}));case 17:case"end":return r.stop()}}),r)})))()},routerTo:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=t.target,a=n.href,o=n.nodeName,"A"===o&&a.includes("viewthread.php?tid=")&&(a=a.replace(/(^.*tid=)(\d.*)&page=(\d.*)#pid(\d.*)/g,"thread-$2-$3-1.html#postmessage_$4"),s=e.$route,i=s.params,c=s.hash,i.url+c!=a&&e.$router.push(a),t.preventDefault(),t.stopPropagation());case 2:case"end":return r.stop()}}),r)})))()}})},p=d,f=(r("602e"),r("2877")),g=Object(f["a"])(p,n,a,!1,null,null,null);e["default"]=g.exports},"4fea":function(t,e,r){"use strict";r("a952")},"5a34":function(t,e,r){var n=r("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"602e":function(t,e,r){"use strict";r("75c4")},"75c4":function(t,e,r){},"760c":function(t,e,r){},9703:function(t,e,r){},a434:function(t,e,r){"use strict";var n=r("23e7"),a=r("23cb"),o=r("a691"),s=r("50c4"),i=r("7b0b"),c=r("65f0"),u=r("8418"),l=r("1dde"),d=l("splice"),p=Math.max,f=Math.min,g=9007199254740991,h="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var r,n,l,d,m,v,b=i(this),w=s(b.length),x=a(t,w),_=arguments.length;if(0===_?r=n=0:1===_?(r=0,n=w-x):(r=_-2,n=f(p(o(e),0),w-x)),w+r-n>g)throw TypeError(h);for(l=c(b,n),d=0;d<n;d++)m=x+d,m in b&&u(l,d,b[m]);if(l.length=n,r<n){for(d=x;d<w-n;d++)m=d+n,v=d+r,m in b?b[v]=b[m]:delete b[v];for(d=w;d>w-n+r;d--)delete b[d-1]}else if(r>n)for(d=w-n;d>x;d--)m=d+n-1,v=d+r-1,m in b?b[v]=b[m]:delete b[v];for(d=0;d<r;d++)b[d+x]=arguments[d+2];return b.length=w-n+r,l}})},a692:function(t,e,r){"use strict";r("760c")},a777:function(t,e,r){"use strict";r("9703")},a952:function(t,e,r){},aa9a:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{class:t.isOpened&&"opened"},[r("svg",{staticStyle:{position:"absolute",width:"0",height:"0"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[r("defs",[r("symbol",{attrs:{id:"icon-close",viewBox:"0 0 32 32"}},[r("title",[t._v("close")]),r("path",{attrs:{d:"M17.387 16l8.907-8.907c0.373-0.373 0.373-1.013 0-1.44-0.373-0.373-1.013-0.373-1.387 0l-8.907 8.907-8.907-8.853c-0.373-0.373-1.013-0.373-1.44 0-0.373 0.373-0.373 1.013 0 1.387l8.907 8.907-8.907 8.907c-0.373 0.373-0.373 1.013 0 1.44 0.373 0.373 1.013 0.373 1.387 0l8.907-8.907 8.907 8.907c0.373 0.373 1.013 0.373 1.387 0 0 0 0 0 0 0 0.373-0.373 0.373-1.013 0-1.44l-8.853-8.907z"}})])])]),r("a",{staticClass:"btn-menu",on:{click:t.toggleclass}},[r("svg",[r("use",{attrs:{"xlink:href":"#icon-close"}})])]),r("li",[r("span",{on:{click:t.saveProgress}},[t._v("收藏")])]),t.hasProgress?r("li",[r("span",{on:{click:t.delProgress}},[t._v("删除")])]):t._e(),t.tid&&t.fid?r("li",[r("span",{on:{click:t.onReply}},[t._v("回复")])]):t._e(),r("li",[r("span",{on:{click:t.onReload}},[t._v("刷新")])])])},a=[],o=(r("4de4"),r("c740"),r("a434"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reply-modal"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],attrs:{type:"text",placeholder:"选填,请输入标题"},domProps:{value:t.subject},on:{input:function(e){e.target.composing||(t.subject=e.target.value)}}}),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"必填,请输入最少20个字内容"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),r("ul",[r("li",{staticClass:"btn submit",on:{click:t.submit}},[t._v("提交")]),r("li",{staticClass:"btn cancel",on:{click:t.closeModal}},[t._v("取消")])])])}),s=[],i=r("1da1"),c=r("5530"),u=(r("96cf"),r("2f62")),l={props:["url","fid","tid"],data:function(){return{subject:"",message:""}},destroyed:function(){},methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["submitReply"])),{},{submit:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.subject,a=e.message,o=e.fid,s=e.tid,r.next=3,e.submitReply({subject:n,message:a,fid:o,tid:s});case 3:e.closeModal(t),setTimeout((function(){sessionStorage.removeItem(e.url),location.reload(!0)}),100);case 5:case"end":return r.stop()}}),r)})))()},closeModal:function(t){this.$emit("closeModal",t)}})},d=l,p=(r("4fea"),r("2877")),f=Object(p["a"])(d,o,s,!1,null,"27d82ad3",null),g=f.exports,h={props:["url","tid","fid"],components:{},data:function(){return{favorites:[],isOpened:!1}},mounted:function(){this.favorites=JSON.parse(localStorage.getItem("favorites"))||[]},computed:{hasProgress:function(){var t=this;return this.favorites.filter((function(e){return e.tid==t.tid}))[0]}},methods:{toggleclass:function(){this.isOpened=!this.isOpened},saveProgress:function(){var t=this,e=this.favorites.findIndex((function(e){return e.tid==t.tid})),r={href:this.url,tid:this.tid,title:document.title,scrollTop:document.querySelector(".overflow-container").scrollTop};e>=0?this.favorites.splice(e,1,r):this.favorites.push(r),localStorage.setItem("favorites",JSON.stringify(this.favorites))},delProgress:function(){var t=this,e=this.favorites.findIndex((function(e){return e.tid==t.tid}));this.favorites.splice(e,1),localStorage.setItem("favorites",JSON.stringify(this.favorites))},onReply:function(){var t=this.$createElement;this.$openModal({position:"bottom",maskClosable:!0,content:t(g,{attrs:{url:this.url,fid:this.fid,tid:this.tid}})}),this.toggleclass()},onReload:function(){sessionStorage.removeItem(this.url),location.reload(!0)}}},m=h,v=(r("a692"),Object(p["a"])(m,n,a,!1,null,"5027dd8c",null));e["a"]=v.exports},ab13:function(t,e,r){var n=r("b622"),a=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[a]=!1,"/./"[t](e)}catch(n){}}return!1}},caad:function(t,e,r){"use strict";var n=r("23e7"),a=r("4d64").includes,o=r("44d2");n({target:"Array",proto:!0},{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")}}]);